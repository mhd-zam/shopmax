<!DOCTYPE html>
<html lang="en">

<head>
  <title>ShopMax &mdash; Colorlib e-Commerce Template</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

   <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,400,700">
  <link rel="stylesheet" href="/user/fonts/icomoon/style.css">
  <link rel="stylesheet" href="/user/stylesheet/bootstrap.min.css">
  <link rel="stylesheet" href="/user/stylesheet/magnific-popup.css">
  <link rel="stylesheet" href="/user/stylesheet/jquery-ui.css">
  <link rel="stylesheet" href="/user/stylesheet/owl.carousel.min.css">
  <link rel="stylesheet" href="/user/stylesheet/owl.theme.default.min.css">
  <link rel="stylesheet" href="/user/stylesheet/aos.css">
  <link rel="stylesheet" href="/user/stylesheet/style.css">
  <link rel="stylesheet" href="/user/stylesheet/search.css">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
    integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
    crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/ace98fed36.js" crossorigin="anonymous"></script>

  <style>
    .fa-solid:hover {
      color: blueviolet;
      cursor: pointer;
    }
  </style>


</head>

<body>

  <div class="site-wrap">


    {{>userheader}}


    <div class="site-section">
      <div class="container">

        <div id="refresh" class="row">
          <div class="col-md-6 mb-5 mb-md-0">
            <h2 class="h3 mb-3 text-black">Billing Details</h2>
            <div class="p-3 p-lg-5 border">
              {{#if address}}
              <h5 class="mt-2">Delivery Addresses</h5>
              <form id="default">
                {{#each address}}
                <div class="card mt-2">
                  <div class="card-body  style=" border-radius:10px;">
                    <i style="float: right;font-size: small;" onclick="editaddress('{{this.address._id}}')"
                      class="fa-solid fa-file-pen " data-bs-toggle="modal" data-bs-target="#exampleModal"></i>
                    <h6 class="card-title bg-primary text-light" style="border-radius:20px;width:100px;"> <input
                        class="form-check-input ml-1 " checked type="radio" name="id" value={{this.address._id}}><span
                        class="ml-4">use this</span></h6>
                    <span class="card-title pl-4">{{this.address.fname}}</span><br>
                    <span class="card-title pl-4">{{this.address.phonenumber}}</span><br>
                    <span class="card-text  ">
                      <span class="pl-4">{{this.address.address}}
                        {{this.address.state}},{{this.address.postalzip}}</span>
                  </div>
                </div>
                {{/each}}
                <a data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false"
                  aria-controls="collapseExample">
                  view more address
                </a>
                {{#each otheradd}}
                <div class="collapse mt-1" id="collapseExample">
                  <div class="card " style="max-width:27.5rem;height:auto;">
                    <div class="card-body" style="padding-top:0%;padding-bottom:0%;">
                      <i style="float: right;font-size: small;" onclick="editaddress('{{this.address._id}}')"
                        class="fa-solid fa-file-pen mt-1 " data-bs-toggle="modal" data-bs-target="#exampleModal"></i>
                         <input class="form-check-input" type="radio" name="id" value={{this.address._id}}>
                      <span style="font-size:smaller;" class="card-title">{{this.address.fname}}<br>
                        {{this.address.phonenumber}}
                        {{this.address.address}}
                        {{this.address.state}},{{this.address.postalzip}}</span>
                    </div>
                  </div>
                </div>
                {{/each}}
                <div>
                  <input  type="submit" class="btn btn-primary btn-block mt-2 " value="USE THIS ADDRESS">
                </div>

              </form>
              {{!-- modal start --}}
              <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">EDIT ADDRESS</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i
                          class="fa-solid fa-xmark"></i></button>
                    </div>
                    <div class="modal-body">
                      <form id="editform">
                        <div class="form-group row">
                          <div class="col-md-6">
                            <input type="text" class="form-control" id="id" name="addid">
                            <label for="c_fname" class="text-black">Full Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="fname" name="fname">
                          </div>
                        </div>
                        <div class="form-group row">
                          <div class="col-md-12">
                            <label for="c_address" class="text-black">Address <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="address" name="address"
                              placeholder="Street address">
                          </div>
                        </div>
                        <div class="form-group row">
                          <div class="col-md-6">
                            <label for="c_state_country" class="text-black">State <span
                                class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="state" name="state">
                          </div>
                          <div class="col-md-6">
                            <label for="c_postal_zip" class="text-black">Postal / Zip <span
                                class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="postal" name="postalzip">
                          </div>
                        </div>
                        <div class="form-group row mb-5">
                          <div class="col-md-6">
                            <label for="c_phone" class="text-black">Phone <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="phone" name="phonenumber"
                              placeholder="Phonenumber">
                          </div>
                        </div>


                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      <input  type="submit" class="btn btn-primary" value="Save changes">
                    </div>
                    </form>
                  </div>
                </div>
              </div>
              {{!-- modal end --}}

              {{else}}

              {{/if}}

              <form id="checkoutform" class="">
                <div class="form-group ml-3 mt-5">
                  <label for="c_ship_different_address" class="text-black" data-toggle="collapse"
                    href="#ship_different_address" role="button" aria-expanded="false"
                    aria-controls="ship_different_address"><input type="checkbox" value="1"
                      id="c_ship_different_address">
                    Add a new address</label>
                  <div class="collapse" id="ship_different_address">
                    <div class="py-2">

                      <div class="form-group row">
                        <div class="col-md-6">
                          <input type="text" style="opacity: 0;" class="form-control" id="userid" value="{{uid}}"
                            name="userid">
                          <label for="c_fname" class="text-black">Full Name <span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_fname" name="fname">
                        </div>
                      </div>



                      <div class="form-group row">
                        <div class="col-md-12">
                          <label for="c_address" class="text-black">Address <span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_address" name="address"
                            placeholder="Street address">
                        </div>
                      </div>

                      <div class="form-group row">
                        <div class="col-md-6">
                          <label for="c_state_country" class="text-black">State <span
                              class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_state_country" name="state">
                        </div>
                        <div class="col-md-6">
                          <label for="c_postal_zip" class="text-black">Postal / Zip <span
                              class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_postal_zip" name="postalzip">
                        </div>
                      </div>

                      <div class="form-group row mb-5">
                        <div class="col-md-6">
                          <label for="c_email_address" class="text-black">Email Address <span
                              class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_email_address" name="email">
                        </div>
                        <div class="col-md-6">
                          <label for="c_phone" class="text-black">Phone <span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="c_phone" name="phonenumber"
                            placeholder="Phonenumber">
                        </div>
                      </div>
                      <div class="form-group row">
                        <div class="col-md-12">
                          <input type="submit" class="btn btn-success" value="SAVE AND DELIVER HERE">
                        </div>
                      </div>

                    </div>

                  </div>
                </div>

              </form>

            </div>
          </div>
          <div class="col-md-6">
            <div class="row mb-5">
              <div class="col-md-12">
                <h2 class="h3 mb-3 text-black">Your Order</h2>
                <div class="p-3 p-lg-5 border">
                  <table class="table site-block-order-table mb-5">
                    <thead>
                      <th>Product</th>
                      <th>Total</th>
                    </thead>
                    <tbody>
                      {{#each checkout}}
                      <tr>
                        <td>{{this.product.product}}<strong class="mx-2">x</strong>{{this.quantity}}</td>
                        <td>₹{{this.gtotal}}</td>
                      </tr>
                      {{/each}}
                      <tr>
                        <td class="text-black "><strong>Cart Subtotal</strong></td>
                        <td class="text-black">₹{{total}}</td>
                      </tr>
                      <tr>
                        <td class="text-black "><strong>Order Total</strong></td>
                        <td class="text-black "><strong>₹{{total}}</strong></td>
                      </tr>
                    </tbody>
                  </table>



                </div>


              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>

  <footer class="site-footer custom-border-top">
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-lg-3 mb-4 mb-lg-0">
          <h3 class="footer-heading mb-4">Promo</h3>
          <a href="#" class="block-6">
            <img src="images/about_1.jpg" alt="Image placeholder" class="img-fluid rounded mb-4">
            <h3 class="font-weight-light  mb-0">Finding Your Perfect Shirts This Summer</h3>
            <p>Promo from July 15 &mdash; 25, 2019</p>
          </a>
        </div>
        <div class="col-lg-5 ml-auto mb-5 mb-lg-0">
          <div class="row">
            <div class="col-md-12">
              <h3 class="footer-heading mb-4">Quick Links</h3>
            </div>
            <div class="col-md-6 col-lg-4">
              <ul class="list-unstyled">
                <li><a href="#">Sell online</a></li>
                <li><a href="#">Features</a></li>
                <li><a href="#">Shopping cart</a></li>
                <li><a href="#">Store builder</a></li>
              </ul>
            </div>
            <div class="col-md-6 col-lg-4">
              <ul class="list-unstyled">
                <li><a href="#">Mobile commerce</a></li>
                <li><a href="#">Dropshipping</a></li>
                <li><a href="#">Website development</a></li>
              </ul>
            </div>
            <div class="col-md-6 col-lg-4">
              <ul class="list-unstyled">
                <li><a href="#">Point of sale</a></li>
                <li><a href="#">Hardware</a></li>
                <li><a href="#">Software</a></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-6 col-lg-3">
          <div class="block-5 mb-5">
            <h3 class="footer-heading mb-4">Contact Info</h3>
            <ul class="list-unstyled">
              <li class="address">203 Fake St. Mountain View, San Francisco, California, USA</li>
              <li class="phone"><a href="tel://23923929210">+2 392 3929 210</a></li>
              <li class="email">emailaddress@domain.com</li>
            </ul>
          </div>

          <div class="block-7">
            <form action="#" method="post">
              <label for="email_subscribe" class="footer-heading">Subscribe</label>
              <div class="form-group">
                <input type="text" class="form-control py-4" id="email_subscribe" placeholder="Email">
                <input type="submit" class="btn btn-sm px-4 btn-primary" value="Send">
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="row pt-5 mt-5 text-center">
        <div class="col-md-12">
          <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;
            <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with
            <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank"
              class="text-primary">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
          </p>
        </div>

      </div>
    </div>
  </footer>
  </div>
  <script src="/user/js/jquery-3.3.1.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="/user/js/jquery-ui.js"></script>
  <script src="/user/js/popper.min.js"></script>
  <script src="/user/js/bootstrap.min.js"></script>
  <script src="/user/js/owl.carousel.min.js"></script>
  <script src="/user/js/jquery.magnific-popup.min.js"></script>
  <script src="/user/js/aos.js"></script>
  <script src="/user/js/main.js"></script>
  <script src="/user/js/checkout.js"></script>
  <script src="/user/js/default.js"></script>
 <script src="/user/js/count.js"></script>

  <script>
    function editaddress(id) {
      $.ajax({
        url: '/editaddress?addid=' + id,
        method: 'get',
        success: (response) => {
          document.getElementById('id').value = response._id
          document.getElementById('fname').value = response.fname
          document.getElementById('address').value = response.address
          document.getElementById('state').value = response.state
          document.getElementById('postal').value = response.postalzip
          document.getElementById('phone').value = response.phonenumber
        }
      })
    }
  </script>

  <script>
    $("#editform").submit((e) => {
      e.preventDefault()
      $.ajax({
        url: '/editaddress',
        type: 'post',
        data: $('#editform').serialize(),
        success: (response) => {
          $('#exampleModal').modal('hide')
          location.reload()
        }

      })
    })
  </script>

</body>

</html>